(window.webpackJsonp=window.webpackJsonp||[]).push([[32],{646:function(s,n,t){"use strict";t.r(n);var a=t(7),e=Object(a.a)({},(function(){var s=this,n=s.$createElement,t=s._self._c||n;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("p"),t("div",{staticClass:"table-of-contents"},[t("ul",[t("li",[t("a",{attrs:{href:"#一、kubernetese"}},[s._v("一、Kubernetese")]),t("ul",[t("li",[t("a",{attrs:{href:"#_1-1、基础架构如"}},[s._v("1.1、基础架构如")])]),t("li",[t("a",{attrs:{href:"#_1-2、集群整体部署环境"}},[s._v("1.2、集群整体部署环境")])])])]),t("li",[t("a",{attrs:{href:"#二、k8s安装方式"}},[s._v("二、K8S安装方式")]),t("ul",[t("li",[t("a",{attrs:{href:"#_2-1、二进制部署"}},[s._v("2.1、二进制部署，")])]),t("li",[t("a",{attrs:{href:"#_2-2、使用k8官方推出的集群管理工具kubeadm。"}},[s._v("2.2、使用K8官方推出的集群管理工具kubeadm。")])])])])])]),t("p"),s._v(" "),t("blockquote",[t("p",[s._v("Confluence ：由 zhe.dai创建, 最后修改于十一月 07, 2020")])]),s._v(" "),t("h2",{attrs:{id:"一、kubernetese"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#一、kubernetese"}},[s._v("#")]),s._v(" 一、Kubernetese")]),s._v(" "),t("h3",{attrs:{id:"_1-1、基础架构如"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-1、基础架构如"}},[s._v("#")]),s._v(" 1.1、基础架构如")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://img2020.cnblogs.com/blog/1600332/202105/1600332-20210511231230596-520760280.png",alt:"image"}})]),s._v(" "),t("h3",{attrs:{id:"_1-2、集群整体部署环境"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-2、集群整体部署环境"}},[s._v("#")]),s._v(" 1.2、集群整体部署环境")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://img2020.cnblogs.com/blog/1600332/202105/1600332-20210511231244920-482443240.png",alt:"image"}})]),s._v(" "),t("h2",{attrs:{id:"二、k8s安装方式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#二、k8s安装方式"}},[s._v("#")]),s._v(" 二、K8S安装方式")]),s._v(" "),t("ul",[t("li",[s._v("k8s托管在github上（https://github.com/kubernetes）。要安装K8S集群的话常用以下2种方式：")])]),s._v(" "),t("h3",{attrs:{id:"_2-1、二进制部署"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-1、二进制部署"}},[s._v("#")]),s._v(" 2.1、二进制部署，")]),s._v(" "),t("ul",[t("li",[s._v("适合生产。用户需要把Master中心节点的所有组件通通安装，同理Node节点也需要安装对应的核心组件，还需要手动配置多组CA证书，过程非常繁琐。")])]),s._v(" "),t("h3",{attrs:{id:"_2-2、使用k8官方推出的集群管理工具kubeadm。"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2、使用k8官方推出的集群管理工具kubeadm。"}},[s._v("#")]),s._v(" 2.2、使用K8官方推出的集群管理工具kubeadm。")]),s._v(" "),t("ul",[t("li",[s._v("它把原本需要自己部署的组件通过镜像方式拉到本地进行使用，由于证书不是自签，面临过期问题，适合学习K8S使用。用户只需要安装好kubelet和docker，然后每个Master和Node节点上安装kubeadm即可，通过kubeadm init把第一个节点初始化为Master；通过kubeadm join将其他节点初始化为Node并加入集群。")]),s._v(" "),t("li",[s._v("Github项目托管路径 ： https://github.com/kubernetes/kubeadm")])]),s._v(" "),t("h4",{attrs:{id:"_2-2-1、什么是kubeadm"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-1、什么是kubeadm"}},[s._v("#")]),s._v(" 2.2.1、什么是Kubeadm")]),s._v(" "),t("ul",[t("li",[s._v("Kubeadm是一种工具，旨在为创建Kubernetes集群提供最佳实践的“快速路径”。它以用户友好的方式执行必要的操作，以使最低限度的可行，安全的群集启动并运行。Kubeadm的范围仅限于本地节点文件系统和Kubernetes API，它旨在成为高级工具的可组合构建块。")]),s._v(" "),t("li",[s._v("Github 文档介绍 ： https://github.com/kubernetes/kubeadm/blob/master/docs/design/design_v1.10.md")])]),s._v(" "),t("h4",{attrs:{id:"_2-2-2、kubeadm安装k8s"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-2、kubeadm安装k8s"}},[s._v("#")]),s._v(" 2.2.2、Kubeadm安装K8S")]),s._v(" "),t("ul",[t("li",[s._v("阿里云安装 kubelet kubeadm kubectl 示例 ：https://developer.aliyun.com/mirror/kubernetes?spm=a2c6h.13651102.0.0.3e221b11auUzVs")]),s._v(" "),t("li",[s._v("k8s初始化报错解决参考博客：\n"),t("ul",[t("li",[s._v("https://www.jianshu.com/p/0490d7492428")]),s._v(" "),t("li",[s._v("https://blog.csdn.net/qq_34857250/article/details/82562514")]),s._v(" "),t("li",[s._v("https://www.kubernetes.org.cn/5213.html")]),s._v(" "),t("li",[s._v("https://blog.csdn.net/shenhonglei1234/article/details/84946546")]),s._v(" "),t("li",[s._v("https://blog.csdn.net/andriy_dangli/article/details/79269348")]),s._v(" "),t("li",[s._v("https://www.cnblogs.com/omgasw/p/10548334.html")])])])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 环境")]),s._v("\nmaster "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".20.236\nnode1 "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".20.212\nnode2 "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".20.214\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("h5",{attrs:{id:"_2-2-2-1、服务器初始化-环境要求"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-2-1、服务器初始化-环境要求"}},[s._v("#")]),s._v(" 2.2.2.1、服务器初始化（环境要求）")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("一、服务器初始化\n    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("、各个节点host文件初始化 进制使用 -\n    master\n    ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# hostnamectl set-hostname k8s.master1")]),s._v("\n    ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat /etc/hosts")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".1.196 k8s.master1 k8s.master.apiserver\n        "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".1.197 k8s.node1\n        "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".1.198 k8s.node2\n \n     \n    node1\n    ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# hostnamectl set-hostname k8s.node1")]),s._v("\n \n    node2\n    ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# hostnamectl set-hostname k8s.node2")]),s._v("\n \n \n    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("、关闭防火墙\n    ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# chkconfig iptables off  && iptables -F")]),s._v("\n    ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl stop firewalld")]),s._v("\n    ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl disable firewalld")]),s._v("\n \n \n    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("、关闭slinux\n    ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# setenforce 0")]),s._v("\n    ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# sed -i "s/SELINUX=enforcing/SELINUX=disabled/g" /etc/selinux/config')]),s._v("\n \n    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("、关闭swap\n    ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# swapoff -a")]),s._v("\n    ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# yes | cp /etc/fstab /etc/fstab_bak")]),s._v("\n    ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat /etc/fstab_bak |grep -v swap > /etc/fstab")]),s._v("\n \n    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("、时间同步\n    ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# yum install ntpdate -y")]),s._v("\n    ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl enable ntpdate.service")]),s._v("\n    ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# echo '*/30 * * * * /usr/sbin/ntpdate time7.aliyun.com >/dev/null 2>&1' > /tmp/crontab2.tmp")]),s._v("\n    ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# crontab /tmp/crontab2.tmp")]),s._v("\n    ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl start ntpdate.service")]),s._v("\n    ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ntpdate -u ntp.api.bz")]),s._v("\n \n    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v("、文件描述符\n    ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# echo "* soft nofile 65536" >> /etc/security/limits.conf')]),s._v("\n    ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# echo "* hard nofile 65536" >> /etc/security/limits.conf')]),s._v("\n    ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# echo "* soft nproc 65536"  >> /etc/security/limits.conf')]),s._v("\n    ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# echo "* hard nproc 65536"  >> /etc/security/limits.conf')]),s._v("\n    ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# echo "* soft  memlock  unlimited"  >> /etc/security/limits.conf')]),s._v("\n    ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# echo "* hard memlock  unlimited"  >> /etc/security/limits.conf')]),s._v("\n \n    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("、内核参数设置（可选配置项）\n~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat /etc/sysctl.conf")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# sysctl settings are defined through files in")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# /usr/lib/sysctl.d/, /run/sysctl.d/, and /etc/sysctl.d/.")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Vendors settings live in /usr/lib/sysctl.d/.")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# To override a whole file, create a new file with the same in")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# /etc/sysctl.d/ and put new settings there. To override")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# only specific settings, add a file with a lexically later")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# name in /etc/sysctl.d/ and put new settings there.")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# For more information, see sysctl.conf(5) and sysctl.d(5).")]),s._v("\nnet.ipv6.conf.all.disable_ipv6 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\nnet.ipv6.conf.default.disable_ipv6 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\nnet.ipv6.conf.lo.disable_ipv6 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\nvm.swappiness "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nnet.ipv4.neigh.default.gc_stale_time"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("120")]),s._v("\nnet.ipv4.ip_forward "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# see details in https://help.aliyun.com/knowledge_detail/39428.html")]),s._v("\nnet.ipv4.conf.all.rp_filter"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nnet.ipv4.conf.default.rp_filter"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nnet.ipv4.conf.default.arp_announce "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\nnet.ipv4.conf.lo.arp_announce"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\nnet.ipv4.conf.all.arp_announce"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# # see details in https://help.aliyun.com/knowledge_detail/41334.html")]),s._v("\nnet.ipv4.tcp_max_tw_buckets "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5000")]),s._v("\nnet.ipv4.tcp_syncookies "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\nnet.ipv4.tcp_max_syn_backlog "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1024")]),s._v("\nnet.ipv4.tcp_synack_retries "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\nkernel.sysrq "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# # iptables透明网桥的实现")]),s._v("\nnet.bridge.bridge-nf-call-ip6tables "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\nnet.bridge.bridge-nf-call-iptables "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\nnet.bridge.bridge-nf-call-arptables "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n \n~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# modprobe br_netfilter")]),s._v("\n~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# sysctl -p")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br"),t("span",{staticClass:"line-number"},[s._v("45")]),t("br"),t("span",{staticClass:"line-number"},[s._v("46")]),t("br"),t("span",{staticClass:"line-number"},[s._v("47")]),t("br"),t("span",{staticClass:"line-number"},[s._v("48")]),t("br"),t("span",{staticClass:"line-number"},[s._v("49")]),t("br"),t("span",{staticClass:"line-number"},[s._v("50")]),t("br"),t("span",{staticClass:"line-number"},[s._v("51")]),t("br"),t("span",{staticClass:"line-number"},[s._v("52")]),t("br"),t("span",{staticClass:"line-number"},[s._v("53")]),t("br"),t("span",{staticClass:"line-number"},[s._v("54")]),t("br"),t("span",{staticClass:"line-number"},[s._v("55")]),t("br"),t("span",{staticClass:"line-number"},[s._v("56")]),t("br"),t("span",{staticClass:"line-number"},[s._v("57")]),t("br"),t("span",{staticClass:"line-number"},[s._v("58")]),t("br"),t("span",{staticClass:"line-number"},[s._v("59")]),t("br"),t("span",{staticClass:"line-number"},[s._v("60")]),t("br"),t("span",{staticClass:"line-number"},[s._v("61")]),t("br"),t("span",{staticClass:"line-number"},[s._v("62")]),t("br"),t("span",{staticClass:"line-number"},[s._v("63")]),t("br"),t("span",{staticClass:"line-number"},[s._v("64")]),t("br"),t("span",{staticClass:"line-number"},[s._v("65")]),t("br"),t("span",{staticClass:"line-number"},[s._v("66")]),t("br"),t("span",{staticClass:"line-number"},[s._v("67")]),t("br"),t("span",{staticClass:"line-number"},[s._v("68")]),t("br"),t("span",{staticClass:"line-number"},[s._v("69")]),t("br"),t("span",{staticClass:"line-number"},[s._v("70")]),t("br"),t("span",{staticClass:"line-number"},[s._v("71")]),t("br"),t("span",{staticClass:"line-number"},[s._v("72")]),t("br"),t("span",{staticClass:"line-number"},[s._v("73")]),t("br"),t("span",{staticClass:"line-number"},[s._v("74")]),t("br"),t("span",{staticClass:"line-number"},[s._v("75")]),t("br"),t("span",{staticClass:"line-number"},[s._v("76")]),t("br"),t("span",{staticClass:"line-number"},[s._v("77")]),t("br"),t("span",{staticClass:"line-number"},[s._v("78")]),t("br"),t("span",{staticClass:"line-number"},[s._v("79")]),t("br"),t("span",{staticClass:"line-number"},[s._v("80")]),t("br"),t("span",{staticClass:"line-number"},[s._v("81")]),t("br"),t("span",{staticClass:"line-number"},[s._v("82")]),t("br"),t("span",{staticClass:"line-number"},[s._v("83")]),t("br"),t("span",{staticClass:"line-number"},[s._v("84")]),t("br"),t("span",{staticClass:"line-number"},[s._v("85")]),t("br")])]),t("h5",{attrs:{id:"_2-2-2-2、所有节点安装kubelet-、kubeadm-、docker、kubectl"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-2-2、所有节点安装kubelet-、kubeadm-、docker、kubectl"}},[s._v("#")]),s._v(" 2.2.2.2、所有节点安装kubelet 、kubeadm 、docker、kubectl")]),s._v(" "),t("ul",[t("li",[s._v("阿里云安装 kubelet kubeadm kubectl 示例 ：https://developer.aliyun.com/mirror/kubernetes?spm=a2c6h.13651102.0.0.3e221b11auUzVs")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("二、master 、nodes 节点 ： 安装kubelet 、kubeadm 、docker、kubectl（apiserver命令行客户端，node可不安装）\n    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("、各个节点主机上安装docker\n    yum.repos.d"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# pwd")]),s._v("\n        /etc/yum.repos.d\n    yum.repos.d"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# wget https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo     #下载的docker源为阿里云")]),s._v("\n    yum.repos.d"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# yum install docker-ce -y")]),s._v("\n \n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("、由于不可描述的事实需要修改docker 配置文件\n~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat /etc/docker/daemon.json")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"exec-opts"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"native.cgroupdriver=systemd"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(",   "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cgroup驱动修改为systemd")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"log-driver"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"json-file"')]),s._v(",\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"log-opts"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"max-size"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"100m"')]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"storage-driver"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"overlay2"')]),s._v(",\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"registry-mirrors"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"https://registry.docker-cn.com"')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"https://docker.mirrors.ustc.edu.cn"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n \n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("、重新加载、启动docker\n        systemctl restart "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" info     "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 确认配置是否生效")]),s._v("\n     \n     \n    阿里云：kubernetes镜像仓库 ：https://developer.aliyun.com/mirror/kubernetes?spm"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("a2c6h.13651102.0.0.3e221b11xaCXyk\n \n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("、各个节点配置阿里云k8s镜像仓库并安装k8s\nyum.repos.d"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#cat <<EOF > /etc/yum.repos.d/kubernetes.repo")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("kubernetes"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("Kubernetes\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("baseurl")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("https://mirrors.aliyun.com/kubernetes/yum/repos/kubernetes-el7-x86_64/\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("enabled")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("gpgcheck")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("repo_gpgcheck")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("gpgkey")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("https://mirrors.aliyun.com/kubernetes/yum/doc/yum-key.gpg https://mirrors.aliyun.com/kubernetes/yum/doc/rpm-package-key.gpg\nEOF\n                                                "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#kubectl：apiserver命令行客户端，node可不安装")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装最新版本  yum.repos.d]# yum install -y kubelet kubeadm kubectl             ")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装时可以指定版本 yum install -y kubelet-1.18.2 kubeadm-1.18.2 kubectl-1.18.2")]),s._v("\n \n \n    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("、确保master节点iptables相关映射文件打开\n    ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat /proc/sys/net/bridge/bridge-nf-call-iptables")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n    ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat /proc/sys/net/bridge/bridge-nf-call-ip6tables")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n \n \n    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v("、查看kubelet安装生成的文件，并编辑配置文件\n    ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# rpm -ql kubelet")]),s._v("\n        /etc/kubernetes/manifests    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#清单文件")]),s._v("\n        /etc/sysconfig/kubelet       "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#配置文件")]),s._v("\n        /usr/bin/kubelet             "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#程序文件")]),s._v("\n        /usr/lib/systemd/system/kubelet.service  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#unit file")]),s._v("\n  \n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#指明其额外的初始化信息的相关选项忽略swap")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ~]# cat /etc/sysconfig/kubelet")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#   KUBELET_EXTRA_ARGS="--fail-swap-on-false"')]),s._v("\n \n \n    ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# vi /usr/lib/systemd/system/kubelet.service.d/10-kubeadm.conf    (#不然初始化时有报错：kubelet 1.1.8.2 node_container_manager_linux.go:57] Failed to create ["kubepods"] cgroup)')]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ExecStart")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/bin/kubelet "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$KUBELET_KUBECONFIG_ARGS")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$KUBELET_CONFIG_ARGS")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$KUBELET_KUBEADM_ARGS")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$KUBELET_EXTRA_ARGS")]),s._v(" --feature-gates "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("SupportPodPidsLimit")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("false --feature-gates "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("SupportNodePidsLimit")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("false\n    ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl daemon-reload  # 重新加载  service unit")]),s._v("\n    ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl restart kubelet # 重启服务")]),s._v("\n \n    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("、master节点将kubelet加入开机自启动\n    ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl start kubelet         # 在没有初始化集群前是报错的")]),s._v("\n    ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl start docker ")]),s._v("\n    ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl enable kubelet   ")]),s._v("\n    ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl enable docker")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br"),t("span",{staticClass:"line-number"},[s._v("45")]),t("br"),t("span",{staticClass:"line-number"},[s._v("46")]),t("br"),t("span",{staticClass:"line-number"},[s._v("47")]),t("br"),t("span",{staticClass:"line-number"},[s._v("48")]),t("br"),t("span",{staticClass:"line-number"},[s._v("49")]),t("br"),t("span",{staticClass:"line-number"},[s._v("50")]),t("br"),t("span",{staticClass:"line-number"},[s._v("51")]),t("br"),t("span",{staticClass:"line-number"},[s._v("52")]),t("br"),t("span",{staticClass:"line-number"},[s._v("53")]),t("br"),t("span",{staticClass:"line-number"},[s._v("54")]),t("br"),t("span",{staticClass:"line-number"},[s._v("55")]),t("br"),t("span",{staticClass:"line-number"},[s._v("56")]),t("br"),t("span",{staticClass:"line-number"},[s._v("57")]),t("br"),t("span",{staticClass:"line-number"},[s._v("58")]),t("br"),t("span",{staticClass:"line-number"},[s._v("59")]),t("br"),t("span",{staticClass:"line-number"},[s._v("60")]),t("br"),t("span",{staticClass:"line-number"},[s._v("61")]),t("br"),t("span",{staticClass:"line-number"},[s._v("62")]),t("br"),t("span",{staticClass:"line-number"},[s._v("63")]),t("br"),t("span",{staticClass:"line-number"},[s._v("64")]),t("br"),t("span",{staticClass:"line-number"},[s._v("65")]),t("br"),t("span",{staticClass:"line-number"},[s._v("66")]),t("br"),t("span",{staticClass:"line-number"},[s._v("67")]),t("br"),t("span",{staticClass:"line-number"},[s._v("68")]),t("br"),t("span",{staticClass:"line-number"},[s._v("69")]),t("br"),t("span",{staticClass:"line-number"},[s._v("70")]),t("br")])]),t("h5",{attrs:{id:"_2-2-2-3、master节点-初始化集群-kubeadm-init"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-2-3、master节点-初始化集群-kubeadm-init"}},[s._v("#")]),s._v(" 2.2.2.3、master节点 初始化集群， kubeadm init")]),s._v(" "),t("ul",[t("li",[s._v("初始化过程可分为三步\n"),t("ul",[t("li",[s._v("初始化控制平面第一节点")]),s._v(" "),t("li",[s._v("配置kubectl命令行的管理员配置")]),s._v(" "),t("li",[s._v("部署网络插件")])])]),s._v(" "),t("li",[s._v("运行kubeadm init 初始化命令参数\n"),t("img",{attrs:{src:"https://img2020.cnblogs.com/blog/1600332/202105/1600332-20210511231742838-2081250210.png",alt:"image"}}),s._v(" "),t("strong",[s._v("网络插件 Flannel Yaml")]),s._v(" ：https://gitee.com/dz6666/cnblogs_classify_code/tree/master/OPS-Kubernetes_Basic/K8S_Basic-kubeadm%E5%88%9D%E5%A7%8B%E5%8C%96Kubernetes%E9%9B%86%E7%BE%A4_kubernetes-version_v1.18.2")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("-kubernetes-version: 用于指定k8s版本；\n-apiserver-advertise-address：用于指定kube-apiserver监听的ip地址,就是 master本机IP地址。\n-pod-network-cidr：用于指定Pod的网络范围； "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.244")]),s._v(".0.0/16\n-service-cidr：用于指定SVC的网络范围；\n-image-repository: 指定阿里云镜像仓库地址\n \n三、master节点 初始化集群， kubeadm init\n    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("、master节点初始化kubeadm命令参数\n        kubeadm init --help    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看帮助")]),s._v("\n            --apiserver-advertise-address string  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#apiserver向外公告的地址，默认监听的0.0.0.0")]),s._v("\n            --apiserver-bind-port  string         "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#apiserver监听的端口，默认端口为6443")]),s._v("\n            --cert-dir  string                    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#加载证书的相关目录，默认为/etc/kubernetes/pki")]),s._v("\n            --ignore-preflight-errors  string     "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#在初始化预检查状态下可以忽略错误")]),s._v("\n                                        swap     "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#忽略swap")]),s._v("\n                                        all      "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#忽略所有")]),s._v("\n            --kubernetes-version  string         "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#k8s版本，(default "stable-1")')]),s._v("\n            --pod-network-cidr string            "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#pod使用的网络地址")]),s._v("\n            --service-cidr string                "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#service使用的网络地址")]),s._v("\n \n \n    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("、初始化\n        docker"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubeadm init --image-repository registry.aliyuncs.com/google_containers --kubernetes-version v1.18.2 --apiserver-advertise-address 0.0.0.0 --pod-network-cidr=10.244.0.0/16 --token-ttl 0")]),s._v("\n                                                                                                                                                         \n            "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看报错 docker]# journalctl -xeu kubelet")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# 报错：kubelet 1.1.8.2 node_container_manager_linux.go:57] Failed to create ["kubepods"] cgroup')]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 解决 ：vi /usr/lib/systemd/system/kubelet.service.d/10-kubeadm.conf   ---\x3e ExecStart=/usr/bin/kubelet $KUBELET_KUBECONFIG_ARGS $KUBELET_CONFIG_ARGS $KUBELET_KUBEADM_ARGS $KUBELET_EXTRA_ARGS --feature-gates SupportPodPidsLimit=false --feature-gates SupportNodePidsLimit=false    --\x3e systemctl restart kubelet # 重启服务")]),s._v("\n \n \n \n----\n \n \n~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vi /usr/lib/systemd/system/kubelet.service.d/10-kubeadm.conf")]),s._v("\n \n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Service"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n \n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("Environment")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"KUBELET_KUBECONFIG_ARGS=--bootstrap-kubeconfig=/etc/kubernetes/bootstrap-kubelet.conf --kubeconfig=/etc/kubernetes/kubelet.conf"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("Environment")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"KUBELET_CONFIG_ARGS=--config=/var/lib/kubelet/config.yaml"')]),s._v("\n \n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("EnvironmentFile")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("-/var/lib/kubelet/kubeadm-flags.env\n \n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("EnvironmentFile")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("-/etc/sysconfig/kubelet\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ExecStart")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#ExecStart=/usr/bin/kubelet $KUBELET_KUBECONFIG_ARGS $KUBELET_CONFIG_ARGS $KUBELET_KUBEADM_ARGS $KUBELET_EXTRA_ARGS")]),s._v("\n \n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ExecStart")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/bin/kubelet "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$KUBELET_KUBECONFIG_ARGS")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$KUBELET_CONFIG_ARGS")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$KUBELET_KUBEADM_ARGS")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$KUBELET_EXTRA_ARGS")]),s._v(" --feature-gates "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("SupportPodPidsLimit")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("false --feature-gates "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("SupportNodePidsLimit")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("false\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("Environment")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"KUBELET_CGROUP_ARGS=--cgroup-driver=systemd"')]),s._v("\n \n----\n \n \n         \n            "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 成功")]),s._v("\n            Your Kubernetes control-plane has initialized successfully"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("\n            To start using your cluster, you need to run the following as a regular user:\n                "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" -p "),t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$HOME")]),s._v("/.kube\n                "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" -i /etc/kubernetes/admin.conf "),t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$HOME")]),s._v("/.kube/config\n                "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("chown")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("id")]),s._v(" -u"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("id")]),s._v(" -g"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v(" "),t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$HOME")]),s._v("/.kube/config\n            You should now deploy a pod network to the cluster.\n            Run "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"kubectl apply -f [podnetwork].yaml"')]),s._v(" with one of the options listed at:\n                https://kubernetes.io/docs/concepts/cluster-administration/addons/\n            Then you can "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("join")]),s._v(" any number of worker nodes by running the following on each as root:\n                kubeadm "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("join")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".20.236:6443 --token m7yu3o.iceuvk7tynjcsl11 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n                 --discovery-token-ca-cert-hash sha256:d4efbb35b4910b27aedff1c7dcca2a064db218641c24578242620ccd8e625a44\n \n \n \n    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("、生成kubectl命令的管理员配置\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# 建议使用Linux系统的普通用户身份执行后续操作  （创建用户设置密码，授权  echo "username=(ALL:ALL)NOPASSWD:ALL" > /etc/sudoers.d/username）')]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mkdir -p $HOME/.kube")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cp -i /etc/kubernetes/admin.conf $HOME/.kube/config")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# chown $(id -u):$(id -g) $HOME/.kube/config")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 执行显示集群节点进行验证")]),s._v("\n        ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl get nodes    ")]),s._v("\n            NAME          STATUS     ROLES    AGE   VERSION\n            k8s.master1   NotReady   master   14h   v1.18.2\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 部署网络插件")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubernetes以插件方式支持众多第三方的pod网络实现，著名有flannel和calico等，这里以flannel为示例进行说明")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# flannel_github : https://github.com/coreos/flannel")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# For Kubernetes v1.7+ kubectl apply -f https://raw.githubusercontent.com/coreos/flannel/master/Documentation/kube-flannel.yml")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 但是由于网络问题可能执行不了")]),s._v("\n            ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl apply -f https://raw.githubusercontent.com/coreos/flannel/master/Documentation/kube-flannel.yml")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 可以查看mage github")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# https://github.com/K8SClub/container-basics/blob/master/k8s/kubeadm/kube-flannel.yaml")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# https://www.cnblogs.com/liuyi778/p/12103020.html")]),s._v("\n                    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 修改 #168")]),s._v("\n                          - name: kube-flannel\n                            image: quay-mirror.qiniu.com/coreos/flannel:v0.12.0-amd64\n                    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 手动拉取镜像")]),s._v("\n                        k8s"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker pull quay-mirror.qiniu.com/coreos/flannel:v0.12.0-amd64")]),s._v("\n                 \n            "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 部署（声明式api）")]),s._v("\n                k8s"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl apply -f kube-flannel_mirror12.yaml")]),s._v("\n                    podsecuritypolicy.policy/psp.flannel.unprivileged created\n                    clusterrole.rbac.authorization.k8s.io/flannel created\n                    clusterrolebinding.rbac.authorization.k8s.io/flannel created\n                    serviceaccount/flannel created\n                    configmap/kube-flannel-cfg created\n                    daemonset.apps/kube-flannel-ds-amd64 created\n                    daemonset.apps/kube-flannel-ds-arm64 created\n                    daemonset.apps/kube-flannel-ds-arm created\n                    daemonset.apps/kube-flannel-ds-ppc64le created\n                    daemonset.apps/kube-flannel-ds-s390x created\n \n            "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 验证部署结果")]),s._v("\n                k8s"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl get pods -n kube-system")]),s._v("\n                    NAME                                  READY   STATUS    RESTARTS   AGE\n                    coredns-7ff77c879f-2sn2f              "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("/1     Pending   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          14h\n                    coredns-7ff77c879f-8qqdb              "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("/1     Pending   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          14h\n                    etcd-k8s.master1                      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     Running   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          14h\n                    kube-apiserver-k8s.master1            "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     Running   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          14h\n                    kube-controller-manager-k8s.master1   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     Running   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          14h\n                    kube-flannel-ds-amd64-9ck78           "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     Running   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          22s\n                    kube-proxy-4p84s                      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     Running   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          14h\n                    kube-scheduler-k8s.master1            "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     Running   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          14h \n \n \n            "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 发现kubeadm初始化k8s时coredns无法运行解决它")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 补充，我这里的coredns状态为pending,我就直接修改了coredns镜像支持去互联网下载即进删除了loop， 如果为CrashLoopBackOff状态，则要先删除loop，再使用kubectl delete pod coredns-xxx-xxxx     -n kube-system 将未运行的coredns全部删除，会自动启动coredns")]),s._v("\n                k8s"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl edit cm coredns -n kube-system")]),s._v("\n                    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 22行 删除loop")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#重启 coredns pod (先删除)")]),s._v("\n                    k8s"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl get pods -n kube-system")]),s._v("\n                        NAME                                  READY   STATUS    RESTARTS   AGE\n                        coredns-7ff77c879f-2sn2f              "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     Running   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          14h\n                        coredns-7ff77c879f-8qqdb              "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     Running   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          14h\n                        etcd-k8s.master1                      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     Running   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          14h\n                        kube-apiserver-k8s.master1            "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     Running   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          14h\n                        kube-controller-manager-k8s.master1   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     Running   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          14h\n                        kube-flannel-ds-amd64-9ck78           "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     Running   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          6m6s\n                        kube-proxy-4p84s                      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     Running   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          14h\n                        kube-scheduler-k8s.master1            "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     Running   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          14h\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br"),t("span",{staticClass:"line-number"},[s._v("45")]),t("br"),t("span",{staticClass:"line-number"},[s._v("46")]),t("br"),t("span",{staticClass:"line-number"},[s._v("47")]),t("br"),t("span",{staticClass:"line-number"},[s._v("48")]),t("br"),t("span",{staticClass:"line-number"},[s._v("49")]),t("br"),t("span",{staticClass:"line-number"},[s._v("50")]),t("br"),t("span",{staticClass:"line-number"},[s._v("51")]),t("br"),t("span",{staticClass:"line-number"},[s._v("52")]),t("br"),t("span",{staticClass:"line-number"},[s._v("53")]),t("br"),t("span",{staticClass:"line-number"},[s._v("54")]),t("br"),t("span",{staticClass:"line-number"},[s._v("55")]),t("br"),t("span",{staticClass:"line-number"},[s._v("56")]),t("br"),t("span",{staticClass:"line-number"},[s._v("57")]),t("br"),t("span",{staticClass:"line-number"},[s._v("58")]),t("br"),t("span",{staticClass:"line-number"},[s._v("59")]),t("br"),t("span",{staticClass:"line-number"},[s._v("60")]),t("br"),t("span",{staticClass:"line-number"},[s._v("61")]),t("br"),t("span",{staticClass:"line-number"},[s._v("62")]),t("br"),t("span",{staticClass:"line-number"},[s._v("63")]),t("br"),t("span",{staticClass:"line-number"},[s._v("64")]),t("br"),t("span",{staticClass:"line-number"},[s._v("65")]),t("br"),t("span",{staticClass:"line-number"},[s._v("66")]),t("br"),t("span",{staticClass:"line-number"},[s._v("67")]),t("br"),t("span",{staticClass:"line-number"},[s._v("68")]),t("br"),t("span",{staticClass:"line-number"},[s._v("69")]),t("br"),t("span",{staticClass:"line-number"},[s._v("70")]),t("br"),t("span",{staticClass:"line-number"},[s._v("71")]),t("br"),t("span",{staticClass:"line-number"},[s._v("72")]),t("br"),t("span",{staticClass:"line-number"},[s._v("73")]),t("br"),t("span",{staticClass:"line-number"},[s._v("74")]),t("br"),t("span",{staticClass:"line-number"},[s._v("75")]),t("br"),t("span",{staticClass:"line-number"},[s._v("76")]),t("br"),t("span",{staticClass:"line-number"},[s._v("77")]),t("br"),t("span",{staticClass:"line-number"},[s._v("78")]),t("br"),t("span",{staticClass:"line-number"},[s._v("79")]),t("br"),t("span",{staticClass:"line-number"},[s._v("80")]),t("br"),t("span",{staticClass:"line-number"},[s._v("81")]),t("br"),t("span",{staticClass:"line-number"},[s._v("82")]),t("br"),t("span",{staticClass:"line-number"},[s._v("83")]),t("br"),t("span",{staticClass:"line-number"},[s._v("84")]),t("br"),t("span",{staticClass:"line-number"},[s._v("85")]),t("br"),t("span",{staticClass:"line-number"},[s._v("86")]),t("br"),t("span",{staticClass:"line-number"},[s._v("87")]),t("br"),t("span",{staticClass:"line-number"},[s._v("88")]),t("br"),t("span",{staticClass:"line-number"},[s._v("89")]),t("br"),t("span",{staticClass:"line-number"},[s._v("90")]),t("br"),t("span",{staticClass:"line-number"},[s._v("91")]),t("br"),t("span",{staticClass:"line-number"},[s._v("92")]),t("br"),t("span",{staticClass:"line-number"},[s._v("93")]),t("br"),t("span",{staticClass:"line-number"},[s._v("94")]),t("br"),t("span",{staticClass:"line-number"},[s._v("95")]),t("br"),t("span",{staticClass:"line-number"},[s._v("96")]),t("br"),t("span",{staticClass:"line-number"},[s._v("97")]),t("br"),t("span",{staticClass:"line-number"},[s._v("98")]),t("br"),t("span",{staticClass:"line-number"},[s._v("99")]),t("br"),t("span",{staticClass:"line-number"},[s._v("100")]),t("br"),t("span",{staticClass:"line-number"},[s._v("101")]),t("br"),t("span",{staticClass:"line-number"},[s._v("102")]),t("br"),t("span",{staticClass:"line-number"},[s._v("103")]),t("br"),t("span",{staticClass:"line-number"},[s._v("104")]),t("br"),t("span",{staticClass:"line-number"},[s._v("105")]),t("br"),t("span",{staticClass:"line-number"},[s._v("106")]),t("br"),t("span",{staticClass:"line-number"},[s._v("107")]),t("br"),t("span",{staticClass:"line-number"},[s._v("108")]),t("br"),t("span",{staticClass:"line-number"},[s._v("109")]),t("br"),t("span",{staticClass:"line-number"},[s._v("110")]),t("br"),t("span",{staticClass:"line-number"},[s._v("111")]),t("br"),t("span",{staticClass:"line-number"},[s._v("112")]),t("br"),t("span",{staticClass:"line-number"},[s._v("113")]),t("br"),t("span",{staticClass:"line-number"},[s._v("114")]),t("br"),t("span",{staticClass:"line-number"},[s._v("115")]),t("br"),t("span",{staticClass:"line-number"},[s._v("116")]),t("br"),t("span",{staticClass:"line-number"},[s._v("117")]),t("br"),t("span",{staticClass:"line-number"},[s._v("118")]),t("br"),t("span",{staticClass:"line-number"},[s._v("119")]),t("br"),t("span",{staticClass:"line-number"},[s._v("120")]),t("br"),t("span",{staticClass:"line-number"},[s._v("121")]),t("br"),t("span",{staticClass:"line-number"},[s._v("122")]),t("br"),t("span",{staticClass:"line-number"},[s._v("123")]),t("br"),t("span",{staticClass:"line-number"},[s._v("124")]),t("br"),t("span",{staticClass:"line-number"},[s._v("125")]),t("br"),t("span",{staticClass:"line-number"},[s._v("126")]),t("br"),t("span",{staticClass:"line-number"},[s._v("127")]),t("br"),t("span",{staticClass:"line-number"},[s._v("128")]),t("br"),t("span",{staticClass:"line-number"},[s._v("129")]),t("br"),t("span",{staticClass:"line-number"},[s._v("130")]),t("br"),t("span",{staticClass:"line-number"},[s._v("131")]),t("br"),t("span",{staticClass:"line-number"},[s._v("132")]),t("br")])]),t("h5",{attrs:{id:"_2-2-2-4、各集群中nodes节点加入master节点集群-kubeadm-join"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-2-4、各集群中nodes节点加入master节点集群-kubeadm-join"}},[s._v("#")]),s._v(" 2.2.2.4、各集群中nodes节点加入master节点集群， kubeadm join")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("四、各集群中nodes节点加入master节点集群， kubeadm "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("join")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 这里的kubeadm join 是初始化master成功提示的信息")]),s._v("\n \n \n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("、node节点加入集群\n     ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl enable docker && systemctl enable kubelet.service")]),s._v("\n    ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubeadm join 192.168.20.236:6443 --token m7yu3o.iceuvk7tynjcsl11 \\")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("     --discovery-token-ca-cert-hash sha256:d4efbb35b4910b27aedff1c7dcca2a064db218641c24578242620ccd8e625a44\nW0425 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(":43:49.626329   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("12176")]),s._v(" join.go:346"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("preflight"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" WARNING: JoinControlPane.controlPlane settings will be ignored when control-plane flag is not set.\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("preflight"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Running pre-flight checks\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("WARNING Service-Kubelet"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": kubelet "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" is not enabled, please run "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'systemctl enable kubelet.service'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("preflight"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Reading configuration from the cluster"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("preflight"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" FYI: You can "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("look")]),s._v(" at this config "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" with "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'kubectl -n kube-system get cm kubeadm-config -oyaml'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("kubelet-start"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Downloading configuration "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" the kubelet from the "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"kubelet-config-1.18"')]),s._v(" ConfigMap "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" the kube-system namespace\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("kubelet-start"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Writing kubelet configuration to "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/var/lib/kubelet/config.yaml"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("kubelet-start"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Writing kubelet environment "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" with flags to "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/var/lib/kubelet/kubeadm-flags.env"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("kubelet-start"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Starting the kubelet\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("kubelet-start"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Waiting "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" the kubelet to perform the TLS Bootstrap"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n \nThis "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("node")]),s._v(" has joined the cluster:\n* Certificate signing request was sent to apiserver and a response was received.\n* The Kubelet was informed of the new secure connection details.\n \nRun "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'kubectl get nodes'")]),s._v(" on the control-plane to see this "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("node")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("join")]),s._v(" the cluster.\n \nYou have new mail "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" /var/spool/mail/root\n \n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("、master节点查看加入的节点信息，以确保节点全部加入集群中\n    k8s"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl get nodes")]),s._v("\n        NAME          STATUS     ROLES    AGE   VERSION\n        k8s.master1   Ready      master   14h   v1.18.2\n        k8s.node1     NotReady   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("   87s   v1.18.2\n        k8s.node2     NotReady   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("   11s   v1.18.2\n \n \n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("、master节点--"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" 解决node节点一直为NotReady状态（好大一段时间也无法Ready）\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看kube-system名称空间下的系统Pod")]),s._v("\n        k8s"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl get pod -n kube-system")]),s._v("\n            NAME                                  READY   STATUS    RESTARTS   AGE\n            coredns-7ff77c879f-2sn2f              "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     Running   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          15h\n            coredns-7ff77c879f-8qqdb              "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     Running   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          15h\n            etcd-k8s.master1                      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     Running   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          15h\n            kube-apiserver-k8s.master1            "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     Running   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          15h\n            kube-controller-manager-k8s.master1   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     Running   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          15h\n            kube-flannel-ds-amd64-9ck78           "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     Running   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          26m\n            kube-flannel-ds-amd64-hblzk           "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("/1     Pending   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          11m\n            kube-flannel-ds-amd64-vm82d           "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("/1     Pending   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          12m\n            kube-proxy-4p84s                      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     Running   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          15h\n            kube-proxy-kxw2v                      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("/1     Pending   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          12m\n            kube-proxy-sptb7                      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("/1     Pending   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          11m\n            kube-scheduler-k8s.master1            "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     Running   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          15h\n \n \n \n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看flannel 无法启动详情")]),s._v("\n        k8s"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl describe pod kube-flannel-ds-amd64-hblzk -n kube-system")]),s._v("\n            Containers:\n             kube-flannel:\n                Image:      quay-mirror.qiniu.com/coreos/flannel:v0.12.0-amd64    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动所需要的镜像")]),s._v("\n        k8s"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker images | grep quay-mirror.qiniu.com/coreos/flannel:v0.12.0-amd64  # 发现master节点上存在此镜像（如果不存在可以参开：https://blog.csdn.net/yrx420909/article/details/105667618/）")]),s._v("\n         \n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# node节点修改kubectl配置文件 （参开博客：https://blog.csdn.net/qq_43699928/article/details/101011135）")]),s._v("\n        ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#  vi /usr/lib/systemd/system/kubelet.service.d/10-kubeadm.conf")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ExecStart")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/bin/kubelet "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$KUBELET_KUBECONFIG_ARGS")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$KUBELET_CONFIG_ARGS")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$KUBELET_KUBEADM_ARGS")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$KUBELET_EXTRA_ARGS")]),s._v(" --feature-gates "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("SupportPodPidsLimit")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("false --feature-gates "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("SupportNodePidsLimit")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("false\n        ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl daemon-reload")]),s._v("\n        ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl restart kubelet")]),s._v("\n        ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mkdir .kube")]),s._v("\n \n \n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 将master节点的admin.conf复制到其他节点")]),s._v("\n            k8s"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# scp /etc/kubernetes/admin.conf root@192.168.20.214:/root/.kube/config")]),s._v("\n            k8s"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# scp /etc/kubernetes/admin.conf root@192.168.20.212:/root/.kube/config")]),s._v("\n         \n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 再次查看运行的pod")]),s._v("\n            k8s"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl get pod -n kube-system")]),s._v("\n                NAME                                  READY   STATUS    RESTARTS   AGE\n                coredns-7ff77c879f-2sn2f              "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     Running   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          15h\n                coredns-7ff77c879f-8qqdb              "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     Running   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          15h\n                etcd-k8s.master1                      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     Running   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          15h\n                kube-apiserver-k8s.master1            "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     Running   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          15h\n                kube-controller-manager-k8s.master1   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     Running   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          15h\n                kube-flannel-ds-amd64-9ck78           "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     Running   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          46m\n                kube-flannel-ds-amd64-hblzk           "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     Running   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          31m\n                kube-flannel-ds-amd64-vm82d           "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     Running   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          32m\n                kube-proxy-4p84s                      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     Running   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          15h\n                kube-proxy-kxw2v                      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     Running   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          32m\n                kube-proxy-sptb7                      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     Running   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          31m\n                kube-scheduler-k8s.master1            "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     Running   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          15h\n \n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 再次查看node节点状态")]),s._v("\n            k8s"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl get nodes")]),s._v("\n                NAME          STATUS   ROLES    AGE   VERSION\n                k8s.master1   Ready    master   15h   v1.18.2\n                k8s.node1     Ready    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("   33m   v1.18.2\n                k8s.node2     Ready    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("   31m   v1.18.2\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br"),t("span",{staticClass:"line-number"},[s._v("45")]),t("br"),t("span",{staticClass:"line-number"},[s._v("46")]),t("br"),t("span",{staticClass:"line-number"},[s._v("47")]),t("br"),t("span",{staticClass:"line-number"},[s._v("48")]),t("br"),t("span",{staticClass:"line-number"},[s._v("49")]),t("br"),t("span",{staticClass:"line-number"},[s._v("50")]),t("br"),t("span",{staticClass:"line-number"},[s._v("51")]),t("br"),t("span",{staticClass:"line-number"},[s._v("52")]),t("br"),t("span",{staticClass:"line-number"},[s._v("53")]),t("br"),t("span",{staticClass:"line-number"},[s._v("54")]),t("br"),t("span",{staticClass:"line-number"},[s._v("55")]),t("br"),t("span",{staticClass:"line-number"},[s._v("56")]),t("br"),t("span",{staticClass:"line-number"},[s._v("57")]),t("br"),t("span",{staticClass:"line-number"},[s._v("58")]),t("br"),t("span",{staticClass:"line-number"},[s._v("59")]),t("br"),t("span",{staticClass:"line-number"},[s._v("60")]),t("br"),t("span",{staticClass:"line-number"},[s._v("61")]),t("br"),t("span",{staticClass:"line-number"},[s._v("62")]),t("br"),t("span",{staticClass:"line-number"},[s._v("63")]),t("br"),t("span",{staticClass:"line-number"},[s._v("64")]),t("br"),t("span",{staticClass:"line-number"},[s._v("65")]),t("br"),t("span",{staticClass:"line-number"},[s._v("66")]),t("br"),t("span",{staticClass:"line-number"},[s._v("67")]),t("br"),t("span",{staticClass:"line-number"},[s._v("68")]),t("br"),t("span",{staticClass:"line-number"},[s._v("69")]),t("br"),t("span",{staticClass:"line-number"},[s._v("70")]),t("br"),t("span",{staticClass:"line-number"},[s._v("71")]),t("br"),t("span",{staticClass:"line-number"},[s._v("72")]),t("br"),t("span",{staticClass:"line-number"},[s._v("73")]),t("br"),t("span",{staticClass:"line-number"},[s._v("74")]),t("br"),t("span",{staticClass:"line-number"},[s._v("75")]),t("br"),t("span",{staticClass:"line-number"},[s._v("76")]),t("br"),t("span",{staticClass:"line-number"},[s._v("77")]),t("br"),t("span",{staticClass:"line-number"},[s._v("78")]),t("br"),t("span",{staticClass:"line-number"},[s._v("79")]),t("br"),t("span",{staticClass:"line-number"},[s._v("80")]),t("br"),t("span",{staticClass:"line-number"},[s._v("81")]),t("br"),t("span",{staticClass:"line-number"},[s._v("82")]),t("br"),t("span",{staticClass:"line-number"},[s._v("83")]),t("br"),t("span",{staticClass:"line-number"},[s._v("84")]),t("br"),t("span",{staticClass:"line-number"},[s._v("85")]),t("br"),t("span",{staticClass:"line-number"},[s._v("86")]),t("br"),t("span",{staticClass:"line-number"},[s._v("87")]),t("br"),t("span",{staticClass:"line-number"},[s._v("88")]),t("br"),t("span",{staticClass:"line-number"},[s._v("89")]),t("br"),t("span",{staticClass:"line-number"},[s._v("90")]),t("br"),t("span",{staticClass:"line-number"},[s._v("91")]),t("br"),t("span",{staticClass:"line-number"},[s._v("92")]),t("br"),t("span",{staticClass:"line-number"},[s._v("93")]),t("br"),t("span",{staticClass:"line-number"},[s._v("94")]),t("br"),t("span",{staticClass:"line-number"},[s._v("95")]),t("br")])])])}),[],!1,null,null,null);n.default=e.exports}}]);