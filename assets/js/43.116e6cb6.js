(window.webpackJsonp=window.webpackJsonp||[]).push([[43],{660:function(i,t,s){"use strict";s.r(t);var l=s(7),a=Object(l.a)({},(function(){var i=this,t=i.$createElement,s=i._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":i.$parent.slotKey}},[s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"title"}),s("p",[s("img",{attrs:{src:"https://atlas.pingcode.com/files/public/6231b167274edad1ad534662",alt:"image.png"}})])]),i._v(" "),s("p"),s("div",{staticClass:"table-of-contents"},[s("ul",[s("li",[s("a",{attrs:{href:"#一、部署istio控制平面"}},[i._v("一、部署Istio控制平面")]),s("ul",[s("li",[s("a",{attrs:{href:"#_1-1、三种部署方法介绍"}},[i._v("1.1、三种部署方法介绍")])]),s("li",[s("a",{attrs:{href:"#_1-2、istio内置的部署档案-共8种-以下是常用的6种"}},[i._v("1.2、Istio内置的部署档案(共8种，以下是常用的6种)")])]),s("li",[s("a",{attrs:{href:"#_1-3、istio-operator-api各配置段说明"}},[i._v("1.3、Istio Operator API各配置段说明")])]),s("li",[s("a",{attrs:{href:"#_1-4、使用istioctl-快速部署istio"}},[i._v("1.4、使用istioctl 快速部署Istio")])]),s("li",[s("a",{attrs:{href:"#_1-5、卸载istio"}},[i._v("1.5、卸载Istio")])])])])])]),s("p"),i._v(" "),s("blockquote",[s("p",[i._v("istio官方手册 ：https://istio.io/latest/docs/setup/getting-started/")])]),i._v(" "),s("h2",{attrs:{id:"一、部署istio控制平面"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#一、部署istio控制平面"}},[i._v("#")]),i._v(" 一、部署Istio控制平面")]),i._v(" "),s("h3",{attrs:{id:"_1-1、三种部署方法介绍"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-1、三种部署方法介绍"}},[i._v("#")]),i._v(" 1.1、三种部署方法介绍")]),i._v(" "),s("ul",[s("li",[i._v("部署方法\n"),s("ul",[s("li",[i._v("istioctl\n"),s("ul",[s("li",[i._v("Istio的专用管理工具，支持定制控制平面及数据平面；")]),i._v(" "),s("li",[i._v("通过命令行的选项支持完整的 IstioOperator API;")]),i._v(" "),s("li",[i._v("命令行各选项可用于单独设置、以及接收包含IstioOperator自定义资源(CR)的yaml文件；\n"),s("ul",[s("li",[i._v("部署完 istio后会在 k8s中生成很多 CR(自定义资源)，会有一种资源叫 install istio的所属群组。所以其实IstioOperator 就是 install istio一个专门的API；")])])])])]),i._v(" "),s("li",[i._v("Istio Operator\n"),s("ul",[s("li",[i._v("Istio 相关的自定义资源(CR) 的专门控制器，负责自动维护由CR定义的资源对象；")]),i._v(" "),s("li",[i._v("管理员根据需要定义相应的CR配置文件，提交至Kubernetes API Server后，即可由Opterator完成相应的操作；")])])]),i._v(" "),s("li",[i._v("Helm\n"),s("ul",[s("li",[i._v("基于特定的Charts，可以由helm安装Istio；")]),i._v(" "),s("li",[i._v("目前处于Alpha阶段；")])])])])]),i._v(" "),s("li",[i._v("提示\n"),s("ul",[s("li",[i._v("各部署工具依赖的前提条件会有所不同，使用前，需要分别按照其实际要求事先进行准备；")]),i._v(" "),s("li",[i._v("各工具的部署操作，最终都要转换为kubernetes的资源配置文件，并创建于集群上；")])])])]),i._v(" "),s("h3",{attrs:{id:"_1-2、istio内置的部署档案-共8种-以下是常用的6种"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-2、istio内置的部署档案-共8种-以下是常用的6种"}},[i._v("#")]),i._v(" 1.2、Istio内置的部署档案(共8种，以下是常用的6种)")]),i._v(" "),s("ul",[s("li",[i._v("istio 提供了内置配置文件(配置档案)用于快速部署；\n"),s("ul",[s("li",[i._v("default : 根据IstioOperator API 的默认设置启用相关组件，适用于生产环境；")]),i._v(" "),s("li",[i._v("demo : 会部署较多的组件，仅在演示istio功能，适合运行Bookinfo一类的应用程序；")]),i._v(" "),s("li",[i._v("minimal : 类似于default profile ，但仅部署控制平面组件；")]),i._v(" "),s("li",[i._v("remote : 用于配置共享 Control Plane 的多集群环境；")]),i._v(" "),s("li",[i._v("empty : 不部署任何组件，通常帮助用于在自定义profile时生成基础配置信息；")]),i._v(" "),s("li",[i._v("preview : 包含预览性配置的profile，用于探索istio的新功能，但不保证稳定，安全性和性能；")])])]),i._v(" "),s("li",[i._v("配置档案\n"),s("ul",[s("li",[i._v("各配置档案，事实上是 IstioOperator API内置的特定CR格式的配置文件；\n"),s("ul",[s("li",[i._v("CR 名称 ： istiooperators")]),i._v(" "),s("li",[i._v("所属的资源群组 ： install.istio.io/v1alpha1")])])]),i._v(" "),s("li",[i._v("因此，各配置档案也是该资源类型下的资源对象的定义；")])])]),i._v(" "),s("li",[i._v("了解内置的配置档案")])]),i._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[i._v("~# istioctl profile list\n~# istioctl profile dump [PROFILE]\n\n例如打印default档案的资源配置信息\n~# istioctl profile dump default\n--config-path 选项可用于仅打印执行的配置段\n~# istioctl profile diff PROFILE1 PROFILE2\n")])]),i._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[i._v("1")]),s("br"),s("span",{staticClass:"line-number"},[i._v("2")]),s("br"),s("span",{staticClass:"line-number"},[i._v("3")]),s("br"),s("span",{staticClass:"line-number"},[i._v("4")]),s("br"),s("span",{staticClass:"line-number"},[i._v("5")]),s("br"),s("span",{staticClass:"line-number"},[i._v("6")]),s("br"),s("span",{staticClass:"line-number"},[i._v("7")]),s("br")])]),s("ul",[s("li",[i._v("内置的各 profile默认启用的组件会有所不同；")])]),i._v(" "),s("p",[s("img",{attrs:{src:"https://atlas.pingcode.com/files/public/61e3f150bd79bf3f3cdb25c9",alt:"image.png"}})]),i._v(" "),s("h3",{attrs:{id:"_1-3、istio-operator-api各配置段说明"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-3、istio-operator-api各配置段说明"}},[i._v("#")]),i._v(" 1.3、Istio Operator API各配置段说明")]),i._v(" "),s("ul",[s("li",[s("p",[i._v("IstioOperator API 主要包括以下几个配置段；")]),i._v(" "),s("ul",[s("li",[i._v("components : 组件配置参数")]),i._v(" "),s("li",[i._v('hub : 获取各组件镜像的仓库，默认为 "docker.io/istio"')]),i._v(" "),s("li",[i._v("meshConfig : 网格(数据平面) 相关的配置参数")]),i._v(" "),s("li",[i._v("values : 传递给Chart 的各参数值")])])]),i._v(" "),s("li",[s("p",[i._v("IstioOperator API 中定义的组件")]),i._v(" "),s("ul",[s("li",[i._v("base")]),i._v(" "),s("li",[i._v("pilot")]),i._v(" "),s("li",[i._v("ingressGateway")]),i._v(" "),s("li",[i._v("egressGateway")]),i._v(" "),s("li",[i._v("cni")]),i._v(" "),s("li",[i._v("istioRemote")])])]),i._v(" "),s("li",[s("p",[i._v("以下配置段中的各参数，均可在istioctl命令中使用\n--set选项进行独立设置；例如，部署时为default配置档案启用的 debug 日志功能，可以使用以下命令；")])])]),i._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[i._v("~$ istioctl install --set profile=default --set values.global.logging.level=debug\n")])]),i._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[i._v("1")]),s("br")])]),s("h3",{attrs:{id:"_1-4、使用istioctl-快速部署istio"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-4、使用istioctl-快速部署istio"}},[i._v("#")]),i._v(" 1.4、使用istioctl 快速部署Istio")]),i._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[i._v("1、Download Istio\nroot@native01:~# cd /usr/local && curl -L https://istio.io/downloadIstio | sh -\n\nroot@native01:/usr/local# ln -sv istio-1.12.1 istio\n'istio' -> 'istio-1.12.1'\n\n2、增加PATH\nroot@native01:/usr/local# cat /etc/profile\n# Istio\nISTIOPATH=\"/usr/local/istio\"\nPATH=$ISTIOPATH/bin:$PATH\n\n3、查看内置PROFILE档案\nroot@native01:~/istio# istioctl profile list\nIstio configuration profiles:\n    default\n    demo\n    empty\n    external\n    minimal\n    openshift\n    preview\n    remote\n")])]),i._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[i._v("1")]),s("br"),s("span",{staticClass:"line-number"},[i._v("2")]),s("br"),s("span",{staticClass:"line-number"},[i._v("3")]),s("br"),s("span",{staticClass:"line-number"},[i._v("4")]),s("br"),s("span",{staticClass:"line-number"},[i._v("5")]),s("br"),s("span",{staticClass:"line-number"},[i._v("6")]),s("br"),s("span",{staticClass:"line-number"},[i._v("7")]),s("br"),s("span",{staticClass:"line-number"},[i._v("8")]),s("br"),s("span",{staticClass:"line-number"},[i._v("9")]),s("br"),s("span",{staticClass:"line-number"},[i._v("10")]),s("br"),s("span",{staticClass:"line-number"},[i._v("11")]),s("br"),s("span",{staticClass:"line-number"},[i._v("12")]),s("br"),s("span",{staticClass:"line-number"},[i._v("13")]),s("br"),s("span",{staticClass:"line-number"},[i._v("14")]),s("br"),s("span",{staticClass:"line-number"},[i._v("15")]),s("br"),s("span",{staticClass:"line-number"},[i._v("16")]),s("br"),s("span",{staticClass:"line-number"},[i._v("17")]),s("br"),s("span",{staticClass:"line-number"},[i._v("18")]),s("br"),s("span",{staticClass:"line-number"},[i._v("19")]),s("br"),s("span",{staticClass:"line-number"},[i._v("20")]),s("br"),s("span",{staticClass:"line-number"},[i._v("21")]),s("br"),s("span",{staticClass:"line-number"},[i._v("22")]),s("br"),s("span",{staticClass:"line-number"},[i._v("23")]),s("br")])]),s("h3",{attrs:{id:"_1-5、卸载istio"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-5、卸载istio"}},[i._v("#")]),i._v(" 1.5、卸载Istio")]),i._v(" "),s("ul",[s("li",[i._v("使用istioctl命令卸载Istio\n"),s("ul",[s("li",[i._v("命令：istioctl experimental uninstall")])])]),i._v(" "),s("li",[i._v("卸载方法\n"),s("ul",[s("li",[i._v("卸载指定的控制平面\n"),s("ul",[s("li",[i._v("卸载指定文件中定义的控制平面\n"),s("ul",[s("li",[i._v("$ istioctl x uninstall -f")])])]),i._v(" "),s("li",[i._v("卸载指定的Revision\n"),s("ul",[s("li",[i._v("$ istioctl x uninstall --revision")])])]),i._v(" "),s("li",[i._v("基于安装时的选项生成配置信息后经由kubectl命令删除\n"),s("ul",[s("li",[i._v("$ istioctl manifest generate  | kubectl delete -f -")])])]),i._v(" "),s("li",[i._v("清除集群上部署的所有控制平面\n"),s("ul",[s("li",[i._v("$ istioctl x uninstall --purge")])])])])])])]),i._v(" "),s("li",[i._v("提示：控制平面的名称空间默认并不会删除，如果确认不再需要时，需自行进行删除操作;")])])])}),[],!1,null,null,null);t.default=a.exports}}]);